# 英语单词卡片生成器 - 任务执行记录与开发计划

> **版本 v1.0 — 2024-12-26**  
> **项目开发任务管理和进度跟踪**

## 🚨 **开始前必读：GitHub仓库创建**

> **⚠️ 在开始第一个任务之前，必须先创建GitHub仓库！**
> 
> **创建步骤**：
> 1. 在GitHub上创建新仓库（比如：`english-word-card-generator`）
> 2. 本地初始化Git：`git init`
> 3. 添加远程仓库：`git remote add origin <your-repo-url>`
> 4. 首次推送：`git add . && git commit -m "初始项目结构" && git push -u origin main`
> 
> **之后每完成一个小节任务时推送**：`git add . && git commit -m "完成任务X.X" && git push`
> **注意**：完成1.1、1.2、2.1等小节时推送，需要您确认后再执行

---

## 📋 **项目开发状态总览**

| 阶段 | 状态 | 完成度 | 最后更新 |
|------|------|--------|----------|
| 🎨 **UI界面开发** | ✅ 已完成 | 100% | 2024-12-26 |
| 🎯 **核心功能强化** | ⏸️ 待开始 | 0% | 2024-12-26 |
| 🤖 **智能化增强** | ⏸️ 待开始 | 0% | - |
| 🎨 **体验优化** | ⏸️ 待开始 | 0% | - |
| 🧪 **测试与部署** | ⏸️ 待开始 | 0% | - |

---

## 🎯 **MVP开发路线图**

### **阶段一：核心功能强化** 📅 预计2周
> 目标：PDF生成 + API代理架构 + 图片集成

### **阶段二：智能化增强** 📅 预计2周  
> 目标：OpenAI集成 + 智能补全 + 音节拆分

### **阶段三：体验优化** 📅 预计1周
> 目标：错误处理 + 性能优化 + 用户体验

### **阶段四：测试部署** 📅 预计3天
> 目标：生产环境部署和全面测试

---

## 📝 **详细任务清单**

### 🎯 **阶段一：核心功能强化（MVP最高优先级）**

#### **1.1 API代理服务架构搭建** ⭐⭐⭐⭐⭐
- [ ] **状态**：⏸️ 待开始
- [ ] 创建 `src/api/openai.ts` - OpenAI API封装
- [ ] 创建 `src/api/image.ts` - Pexels API封装  
- [ ] 创建 `src/api/dictionary.ts` - 词典API封装
- [ ] 创建 `src/api/types.ts` - API响应类型定义
- [ ] 配置 `.env.local` 环境变量管理

#### **1.2 React-PDF核心实现** ⭐⭐⭐⭐⭐
- [ ] **状态**：⏸️ 待开始
- [ ] 安装并配置 react-pdf 库
- [ ] 创建独立 `CardPreviewPdf.tsx` 组件
- [ ] 实现 85×135mm 卡片尺寸，A4 2×2 排布
- [ ] 实现四线三格PDF布局
- [ ] 嵌入字体：AU School Handwriting + 思源宋体
- [ ] 确保网页预览与PDF输出视觉一致

#### **1.3 数据结构重构（MVP必需）** ⭐⭐⭐⭐
- [ ] **状态**：⏸️ 待开始
- [ ] 修改 `WordCard` 接口，phonics改为string[]
- [ ] 更新 sampleData.ts 中的示例数据格式
- [ ] 修改卡片渲染组件适配新数据结构
- [ ] 更新CSV解析逻辑支持新格式

#### **1.4 Pexels图片API集成** ⭐⭐⭐⭐
- [ ] **状态**：⏸️ 待开始
- [ ] 申请Pexels API Key
- [ ] 创建 `src/api/image.ts` 服务模块
- [ ] 实现图片搜索和筛选功能
- [ ] 添加图片缓存机制避免重复调用
- [ ] 处理API失败的降级方案（默认图片）

---

### 🤖 **阶段二：智能化增强（AI功能集成）**

#### **2.1 音节拆分算法实现** ⭐⭐⭐⭐⭐
- [ ] **状态**：⏸️ 待开始
- [ ] 安装并配置 nlp-syllables 库
- [ ] 创建音节分析服务：`getSyllables(word: string): string[]`
- [ ] 实现音节颜色分配（6-8种浅色，20%透明度）
- [ ] 添加规则引擎备用方案（VCV/VCCV规则）
- [ ] 处理失败情况：无法识别时不显示拼读色块

#### **2.2 OpenAI智能补全系统** ⭐⭐⭐⭐
- [ ] **状态**：⏸️ 待开始
- [ ] 申请OpenAI API Key并配置
- [ ] 完善 `src/api/openai.ts` 服务模块
- [ ] 实现批量释义生成（适合小学生水平）
- [ ] 实现例句生成和中文翻译
- [ ] 实现音标获取（IPA格式）
- [ ] 添加API错误处理和降级策略
- [ ] 实现请求缓存和节流机制

#### **2.3 智能补全逻辑整合** ⭐⭐⭐⭐
- [ ] **状态**：⏸️ 待开始
- [ ] 实现字段优先级：CSV数据 > API补全 > 默认值
- [ ] 创建统一的数据补全服务
- [ ] 实现批量处理逻辑，提高效率
- [ ] 添加数据验证和格式化
- [ ] 实现补全状态的用户反馈

#### **2.4 字典API备用方案** ⭐⭐⭐
- [ ] **状态**：⏸️ 待开始
- [ ] 选择并配置Free Dictionary API
- [ ] 创建 `src/api/dictionary.ts` 服务模块
- [ ] 实现音标获取和数据清洗
- [ ] 添加与OpenAI的切换逻辑
- [ ] 实现多数据源验证机制

---

### 🎨 **阶段三：体验优化**

#### **3.1 错误处理完善**
- [ ] **状态**：⏸️ 待开始
- [ ] 创建全局错误边界组件
- [ ] 实现API错误统一处理
- [ ] 添加用户友好错误提示
- [ ] 实现错误重试机制
- [ ] 添加错误日志记录

#### **3.2 性能优化**
- [ ] **状态**：⏸️ 待开始
- [ ] 实现组件懒加载
- [ ] 优化图片加载策略
- [ ] 实现API请求缓存
- [ ] 优化包大小
- [ ] 添加加载状态提示

#### **3.3 移动端适配**
- [ ] **状态**：⏸️ 待开始
- [ ] 调整移动端布局
- [ ] 优化触摸交互
- [ ] 适配不同屏幕尺寸
- [ ] 测试移动端功能
- [ ] 优化移动端性能

---

### 🧪 **阶段四：测试与部署**

#### **4.1 功能测试**
- [ ] **状态**：⏸️ 待开始
- [ ] 测试单词输入功能
- [ ] 测试CSV导入功能
- [ ] 测试卡片生成功能
- [ ] 测试PDF导出功能
- [ ] 测试错误处理

#### **4.2 部署准备**
- [ ] **状态**：⏸️ 待开始
- [ ] 配置生产环境变量
- [ ] 优化构建配置
- [ ] 准备部署脚本
- [ ] 配置域名和SSL
- [ ] 设置监控和日志

---

## 🔄 **任务操作指南**

### **开始任务时**
1. **更新任务状态**：将状态从 ⏸️ 改为 🟡 进行中
2. **开始编码**：直接开始实现功能

### **完成任务时（每一条任务都要执行）**
1. **更新任务状态**：将状态改为 ✅ 已完成  
2. **📁 立即更新03文档**：**每完成一个任务（每一条任务）都必须更新 `03_项目目录结构说明.md`**
   - 如果有新增文件 → 立即更新目录树
   - 如果有结构修改 → 立即更新相关说明
   - 保持03文档的实时性，确保新chat能准确了解项目结构
3. **通知推送**：在聊天中说明"完成了任务X.X"，等待确认后再推送
4. **🔄 推送到GitHub**（确认后执行）：
   ```bash
   git add .
   git commit -m "完成任务X.X: 具体功能描述"
   git push
   ```
5. **更新本文档**：更新本任务记录文档中的任务状态
6. **测试验证**：确保功能正常工作

### **遇到问题时**
1. **标记状态**：将状态改为 🔴 阻塞
2. **记录问题**：在备注中详细描述问题
3. **解决后**：恢复为 🟡 进行中 状态



---

## ⚠️ **重要提醒**

### **🔔 文档更新提醒**
> **每当完成涉及项目结构变化的任务时，必须更新：**
> - ✅ `doc/项目目录结构说明.md`
> - ✅ 本任务记录文档
> - ✅ 相关技术文档

### **🔑 关键注意事项**
1. **API密钥安全**：绝不在代码中硬编码API密钥
2. **依赖管理**：每次添加新依赖都要更新package.json说明
3. **错误处理**：每个API调用都要有完整的错误处理
4. **性能考虑**：避免不必要的API调用和重复渲染
5. **移动端适配**：确保所有功能在移动端正常工作

### **🎯 MVP完成验收标准**
> **核心流程验收**：
> 1. ✅ CSV上传 → 自动补全 → 卡片预览 → PDF导出的完整流程
> 2. ✅ API代理服务正常工作，密钥安全不暴露
> 3. ✅ PDF输出与网页预览视觉完全一致  
> 4. ✅ 50词PDF生成时间 ≤10秒
> 5. ✅ 调试模式可开关，生产环境自动关闭

### **📋 立即开始的准备工作**
1. **申请API密钥**：
   - OpenAI API Key（用于智能补全）
   - Pexels API Key（用于图片获取，免费）
2. **准备字体文件**：
   - AU School Handwriting Fonts（四线三格字体）
   - 思源宋体或等效中文字体
3. **学习react-pdf**：熟悉基本用法和字体嵌入
4. **开始第一个任务**：1.1 API代理服务架构搭建

---

## 🔧 **开发环境配置指南**

### **API密钥配置**
创建 `.env.local` 文件：
```bash
# OpenAI API配置
OPENAI_API_KEY=sk-xxx

# Pexels API配置
PEXELS_API_KEY=xxx

# 环境设置
NODE_ENV=development
VITE_DEBUG_MODE=true
```

### **字体文件结构**
```
public/fonts/
├── au-school-handwriting.ttf    # 四线三格英文字体
└── source-han-serif.ttf         # 中文字体
```

### **项目结构目标**
```
src/
├── api/                         # 新增：API代理服务
│   ├── openai.ts               # OpenAI API封装
│   ├── image.ts                # Pexels API封装  
│   ├── dictionary.ts           # 词典API封装
│   └── types.ts                # API类型定义
├── components/
│   ├── CardPreview.tsx         # 现有组件
│   ├── CardPreviewPdf.tsx      # 新增：PDF专用组件
│   └── ...
└── ...
```

---

> **💡 使用提示**：
> - 建议每天至少更新一次任务状态
> - 遇到技术难题时及时记录和寻求帮助  
> - 完成重要里程碑时庆祝一下！🎉
> - **记住**：这是MVP版本，专注核心功能，避免过度工程化 