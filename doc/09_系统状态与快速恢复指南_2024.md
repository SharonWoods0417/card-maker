# 系统状态与快速恢复指南 (2024年最新版)

> **重要说明：** 本文档记录系统当前状态，提供万一出现问题时的快速恢复方案

## 📅 最后更新
- **更新日期：** 2024年12月最新版本
- **系统状态：** ✅ 网页预览和下载图片双模式正常工作
- **验证状态：** ✅ 所有样式调整已完成并验证
- **最新优化：** 序号与例句精细化对齐配置完成

## 🎯 当前工作状态

### ✅ 网页预览模式 (`.preview-mode`)
- **四线三格位置**：已调整到最佳位置
- **单词位置**：相对四线三格适度下移
- **音标位置**：适度上移，与四线三格距离合适
- **拼读色块**：尺寸优化，更宽更高，字体清晰
- **卡片背面**：中文释义位置标准，与例句框间距合适
- **例句字体配置**：英文19.2px，中文18px (在原基础上增大20%)
- **序号配置**：字体17px，右边距8px，与例句基线对齐

### ✅ 下载图片模式 (`.print-mode`)
- **拼读色块文字**：成功上提到色块顶部 ✅
- **中文释义**：上移10px，增大与例句框间距 ✅
- **透明度配置**：色块80%半透明，文字100%不透明 ✅
- **图片质量**：高质量A4导出，无动效干扰 ✅
- **例句字体配置**：英文21.6px，中文19.8px (在原基础上减小10%)
- **序号配置**：字体20px，右边距12px，保持协调

## 🛡️ 样式系统分离状态

### 完全独立的双模式系统
```
网页预览模式：使用 .preview-mode 前缀
  ↓
  专门优化网页浏览体验
  ↓
  不影响图片导出

下载图片模式：使用 .print-mode 前缀
  ↓
  专门优化图片导出效果
  ↓
  不影响网页预览
```

### 分离机制验证 ✅
- **网页预览**：样式调整只影响浏览器显示
- **图片导出**：样式调整只影响下载的图片
- **无交叉影响**：两套样式完全独立运行

### 序号与例句对齐验证 ✅
- **基线对齐**：序号与英文例句使用flex布局基线对齐
- **缩进对齐**：中文翻译精确缩进，与英文例句开头对齐
- **字体协调**：序号字体略小于例句文字，保持视觉平衡
- **间距适中**：序号与例句间距适当拉开，提升可读性

## 📁 关键文件状态

### 样式文件
- **`src/index.css`** - 包含双模式完整样式，已验证正常 ✅

### 备份文档
- **`网页预览样式完整备份_2024.md`** - 网页预览模式完整CSS备份 ✅
- **`下载图片样式完整备份_2024.md`** - 下载图片模式完整CSS备份 ✅

### 配置文档
- **`06_卡片排版配置标准.md`** - 总览文档，已更新为导航页面 ✅
- **`00_文档导读.md`** - 已更新，包含新文档结构 ✅

## 🚀 快速恢复方案

### 场景1：网页预览效果异常
**症状：** 网页预览中卡片样式错乱
**解决步骤：**
1. 打开 `src/index.css` 文件
2. 搜索 `.preview-mode` 相关样式
3. 参考 `网页预览样式完整备份_2024.md` 恢复配置
4. 特别检查序号对齐配置是否正确
5. 刷新浏览器验证效果

### 场景2：下载图片效果异常
**症状：** 下载的图片中卡片样式错乱
**解决步骤：**
1. 打开 `src/index.css` 文件
2. 搜索 `.print-mode` 相关样式
3. 参考 `下载图片样式完整备份_2024.md` 恢复配置
4. 特别检查序号字体大小和间距配置
5. 测试下载图片验证效果

### 场景3：序号与例句对齐异常
**症状：** 序号与例句没有对齐，中文翻译缩进不正确
**解决步骤：**
1. 检查 `.sentence-english-line` 的flex布局配置
2. 验证 `.sentence-number` 的固定宽度和边距
3. 确认 `.sentence-chinese` 的缩进计算正确
4. 参考文档中的精确数值进行修复

### 场景4：两种模式相互影响
**症状：** 修改一种模式影响了另一种模式
**解决步骤：**
1. 检查CSS样式是否使用了正确的模式前缀
2. 确保网页预览使用 `.preview-mode` 前缀
3. 确保下载图片使用 `.print-mode` 前缀
4. 参考备份文档完整恢复两套样式

## ⚠️ 关键注意事项

### 样式修改原则
1. **网页预览调整**：只修改 `.preview-mode` 前缀的样式
2. **下载图片调整**：只修改 `.print-mode` 前缀的样式
3. **基础样式**：卡片背面使用基础CSS样式（不带模式前缀）
4. **序号对齐**：涉及多个CSS规则，修改需谨慎
5. **绝对禁止**：修改样式时不能影响另一种模式

### 字体大小配置标准
**网页预览模式：**
- 英文例句：19.2px (基础16px增大20%)
- 中文翻译：18px (基础15px增大20%)
- 序号：17px (略小于例句文字)

**下载图片模式：**
- 英文例句：21.6px (基础24px减小10%)
- 中文翻译：19.8px (基础22px减小10%)
- 序号：20px (略小于例句文字)

### 对齐配置标准
**序号容器：**
- 固定宽度：14px
- 网页预览右边距：8px
- 下载图片右边距：12px

**中文翻译缩进：**
- 网页预览：22px (14px + 8px)
- 下载图片：保持原有样式

### 测试验证步骤
每次样式修改后，必须验证：
1. **网页预览**：在浏览器中检查卡片显示效果
2. **图片导出**：下载A4图片检查导出效果
3. **序号对齐**：验证序号与例句基线对齐
4. **中文缩进**：验证中文翻译正确缩进
5. **双向验证**：确保两种模式互不影响

## 📊 性能状态

### 系统性能指标
- **页面加载速度**：正常
- **样式渲染速度**：正常
- **图片导出速度**：正常
- **内存使用**：稳定

### 代码质量
- **CSS结构**：清晰的模式分离
- **代码重复**：最小化重复，但为了模式独立性保留必要重复
- **维护性**：高，每种模式可独立维护
- **对齐精度**：序号与例句精确对齐，视觉效果优秀

## 🔍 故障排查清单

### 网页预览问题排查
- [ ] 检查浏览器控制台是否有CSS错误
- [ ] 确认字体文件是否正确加载
- [ ] 验证 `.preview-mode` 样式是否生效
- [ ] 检查组件是否正确应用预览模式类名
- [ ] 验证序号对齐配置是否正确

### 下载图片问题排查
- [ ] 检查A4PageRenderer组件的enablePrintMode设置
- [ ] 确认 `.print-mode` 样式是否生效
- [ ] 验证图片导出组件是否正常工作
- [ ] 检查是否有JavaScript错误影响导出
- [ ] 验证序号字体大小和间距配置

### 序号对齐问题排查
- [ ] 检查 `.sentence-english-line` 的flex布局
- [ ] 验证 `.sentence-number` 的宽度和边距
- [ ] 确认 `.sentence-chinese` 的缩进计算
- [ ] 检查基线对齐是否生效

### 通用问题排查
- [ ] 确认src/index.css文件没有语法错误
- [ ] 检查Vite开发服务器是否正常运行
- [ ] 验证所有依赖包是否正确安装
- [ ] 确认项目目录结构完整

## 📈 系统改进建议

### 已完成的优化
- ✅ 双模式样式系统完全分离
- ✅ 完整的样式备份文档
- ✅ 清晰的文档结构重组
- ✅ 详细的恢复指南
- ✅ 序号与例句精细化对齐配置

### 未来可考虑的改进
- 自动化样式备份脚本
- 样式变更检测机制
- 一键恢复功能
- 样式版本管理系统
- 对齐配置的可视化工具

## 🎯 当前优先级

1. **保持现状**：系统工作正常，避免不必要的修改
2. **文档维护**：定期更新备份文档，确保与代码同步
3. **测试验证**：任何修改后都要进行双模式验证
4. **对齐检查**：重点关注序号与例句的对齐效果
5. **问题响应**：出现问题时优先使用本指南快速恢复

## 📋 最新配置摘要

### 网页预览模式核心配置
```css
.preview-mode .sentence-number {
  font-size: 17px;
  margin-right: 8px;
  width: 14px;
}

.preview-mode .sentence-chinese {
  margin-left: 22px; /* 14px + 8px */
}
```

### 下载图片模式核心配置
```css
.print-mode .sentence-number {
  font-size: 20px;
  padding-right: 12px;
}

.print-mode .sentence-english {
  font-size: 21.6px;
}

.print-mode .sentence-chinese {
  font-size: 19.8px;
}
```

---

**总结：** 系统当前处于最佳工作状态，双模式样式完全独立，序号与例句精确对齐，备份文档完整，可以安心使用。如遇问题，请首先参考本文档的快速恢复方案。

**特别说明：** 序号与例句的对齐配置是经过精细调试的，涉及多个CSS规则的协调配合，修改时请务必谨慎，建议完全参照备份文档进行恢复。 